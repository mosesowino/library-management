(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{381:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},672:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>T});var t=r(5155),l=r(6874),n=r.n(l),a=r(7340),o=r(4177),d=r(2548),i=r(9249),c=r(381),h=r(2432),x=r(6697),m=r(7924),u=r(5623),j=r(9018),p=r(285),f=r(6695),g=r(4838),y=r(2523),b=r(8382),w=r(5127),k=r(7313),N=r(6102),v=r(2115),A=r(4746);function T(){let[e,s]=(0,v.useState)([]),[r,l]=(0,v.useState)(!1),[T,M]=(0,v.useState)(null);(0,v.useEffect)(()=>{(async()=>{let e=await fetch("/issued_books");if(!e.ok)throw Error("Failed to fetch issued books");let r=await e.json();s(r),console.log("Issued books data:",r)})()},[]);let C=e=>{if("return"===e[0]){let s=new Date().toISOString().split("T")[0],r=new Date(e[5]),t=new Date(s);console.log("Issue Date:",r),console.log("Return Date:",t);let n=Math.max(1,Math.ceil((t-r)/864e5));console.log("Duration:",n);let a=e[4]*n;console.log("Total Fee:",a),M({id:e[1],name:e[2],title:e[3],fee:a,date:e[5],member_id:e[6],initial_fee:e[4]}),console.log("return book"),l(!0)}};return(0,t.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-slate-800",children:[(0,t.jsxs)("aside",{className:"fixed inset-y-0 left-0 z-10 hidden w-14 flex-col border-r bg-background sm:flex",children:[(0,t.jsxs)("nav",{className:"flex flex-col items-center gap-4 px-2 sm:py-5",children:[(0,t.jsx)(N.TooltipProvider,{children:(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(n(),{href:"/",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,t.jsx)(a.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Dashboard"})]})}),(0,t.jsx)(N.TooltipContent,{side:"right",children:"Dashboard"})]})}),(0,t.jsx)(N.TooltipProvider,{children:(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(n(),{href:"#",className:"flex h-9 w-9 items-center justify-center rounded-lg bg-accent text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,t.jsx)(o.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Issued"})]})}),(0,t.jsx)(N.TooltipContent,{side:"right",children:"Issued"})]})}),(0,t.jsx)(N.TooltipProvider,{children:(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(n(),{href:"/books",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,t.jsx)(d.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"books"})]})}),(0,t.jsx)(N.TooltipContent,{side:"right",children:"books"})]})}),(0,t.jsx)(N.TooltipProvider,{children:(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(n(),{href:"/members",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,t.jsx)(i.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Members"})]})}),(0,t.jsx)(N.TooltipContent,{side:"right",children:"Members"})]})})]}),(0,t.jsx)("nav",{className:"mt-auto flex flex-col items-center gap-4 px-2 sm:py-5",children:(0,t.jsx)(N.TooltipProvider,{children:(0,t.jsxs)(N.Tooltip,{children:[(0,t.jsx)(N.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(n(),{href:"#",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,t.jsx)(c.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Settings"})]})}),(0,t.jsx)(N.TooltipContent,{side:"right",children:"Settings"})]})})})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:gap-4 sm:py-4 sm:pl-14",children:[(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 items-center gap-4 border-b bg-background px-4 sm:static sm:h-auto sm:border-0 sm:bg-transparent sm:px-6",children:[(0,t.jsxs)(b.Sheet,{children:[(0,t.jsx)(b.SheetTrigger,{asChild:!0,children:(0,t.jsxs)(p.$,{size:"icon",variant:"outline",className:"sm:hidden",children:[(0,t.jsx)(h.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle Menu"})]})}),(0,t.jsx)(b.SheetContent,{side:"left",className:"sm:max-w-xs",children:(0,t.jsxs)("nav",{className:"grid gap-6 text-lg font-medium",children:[(0,t.jsxs)(n(),{href:"/",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(a.A,{className:"h-5 w-5"}),"Dashboard"]}),(0,t.jsxs)(n(),{href:"#",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(o.A,{className:"h-5 w-5"}),"Issued"]}),(0,t.jsxs)(n(),{href:"/books",className:"flex items-center gap-4 px-2.5 text-foreground",children:[(0,t.jsx)(d.A,{className:"h-5 w-5"}),"books"]}),(0,t.jsxs)(n(),{href:"/members",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(i.A,{className:"h-5 w-5"}),"Members"]}),(0,t.jsxs)(n(),{href:"#",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(x.A,{className:"h-5 w-5"}),"Settings"]})]})})]}),(0,t.jsx)(j.Qp,{className:"hidden md:flex",children:(0,t.jsxs)(j.AB,{children:[(0,t.jsx)(j.J5,{children:(0,t.jsx)(j.w1,{asChild:!0,children:(0,t.jsx)(n(),{href:"/",children:"Dashboard"})})}),(0,t.jsx)(j.tH,{}),(0,t.jsx)(j.J5,{children:(0,t.jsx)(j.w1,{asChild:!0,children:(0,t.jsx)(n(),{href:"#",children:"Issued"})})})]})}),(0,t.jsxs)("div",{className:"relative ml-auto flex-1 md:grow-0",children:[(0,t.jsx)(m.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(y.p,{type:"search",placeholder:"Search...",className:"w-full rounded-lg bg-background pl-8 md:w-[200px] lg:w-[336px]"})]}),(0,t.jsxs)(g.DropdownMenu,{children:[(0,t.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(p.$,{variant:"outline",size:"icon",className:"overflow-hidden rounded-full",children:"A"})}),(0,t.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(g.DropdownMenuLabel,{children:"My Account"}),(0,t.jsx)(g.DropdownMenuSeparator,{}),(0,t.jsx)(g.DropdownMenuItem,{children:"Settings"}),(0,t.jsx)(g.DropdownMenuItem,{children:"Support"}),(0,t.jsx)(g.DropdownMenuSeparator,{}),(0,t.jsx)(g.DropdownMenuItem,{children:"Logout"})]})]})]}),(0,t.jsx)("main",{className:"grid flex-1 items-start gap-4 p-4 sm:px-6 sm:py-0 md:gap-8",children:(0,t.jsxs)(k.Tabs,{defaultValue:"all",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{className:"ml-auto flex items-center gap-2"})}),(0,t.jsx)(k.TabsContent,{value:"all",children:r?(0,t.jsx)(A.default,{onAction:e=>{console.log("Action chosen:",e),"done"===e?(console.log("return book"),setTimeout(()=>l(!1),5e3)):"cancel"===e&&(console.log("cancel return action"),l(!1))},selectedBook:T}):(0,t.jsxs)(f.Zp,{"x-chunk":"dashboard-06-chunk-0",children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)(f.ZB,{children:"Issued Books"}),(0,t.jsx)(f.BT,{children:"View and manage returns of issued books."})]}),(0,t.jsx)(f.Wu,{children:(0,t.jsxs)(w.XI,{children:[(0,t.jsx)(w.A0,{children:(0,t.jsxs)(w.Hj,{children:[(0,t.jsx)(w.nd,{children:"Member"}),(0,t.jsx)(w.nd,{children:"Book Title"}),(0,t.jsx)(w.nd,{className:"hidden md:table-cell",children:"Price"}),(0,t.jsx)(w.nd,{className:"hidden md:table-cell",children:"Issue Date"}),(0,t.jsx)(w.nd,{children:(0,t.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,t.jsx)(w.BF,{children:e.map(e=>(0,t.jsxs)(w.Hj,{children:[(0,t.jsxs)(w.nA,{className:"font-medium",children:[e.member_name,(0,t.jsx)("br",{}),(0,t.jsxs)("p",{children:["Id:",e.member_id]})]}),(0,t.jsx)(w.nA,{children:e.book_title}),(0,t.jsx)(w.nA,{className:"hidden md:table-cell",children:e.fee}),(0,t.jsx)(w.nA,{className:"hidden md:table-cell",children:e.issue_date}),(0,t.jsx)(w.nA,{children:(0,t.jsxs)(g.DropdownMenu,{children:[(0,t.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(p.$,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,t.jsx)(u.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle menu"})]})}),(0,t.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(g.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(g.DropdownMenuItem,{onClick:()=>C(["return",e.book_id,e.member_name,e.book_title,e.fee,e.issue_date,e.member_id]),children:"Return Book"})]})]})})]},e.book_id))})]})}),(0,t.jsx)(f.wL,{children:(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Showing ",(0,t.jsx)("strong",{children:"1-10"})," of ",(0,t.jsx)("strong",{children:"32"})," ","books"]})})]})})]})})]})]})}},2432:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]])},2548:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("BookOpenText",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]])},4177:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]])},4746:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var t=r(5155),l=r(2115),n=r(285),a=r(6695),o=r(2523);function d(e){let{onAction:s,selectedBook:r}=e,[d,i]=(0,l.useState)(),[c,h]=(0,l.useState)("");console.log("Selected Book:",r);let[x,m]=(0,l.useState)(!1),[u,j]=(0,l.useState)(!1),p=async()=>{try{let e=await fetch("/members/debtUpdate/".concat(r.member_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newDebt:r.fee})}),s=await e.json();e.ok?(h(s.message||"Member debt updated successfully!"),f()):h(s.message||"Failed to update member debt.")}catch(e){h("Failed to update member debt.")}},f=async()=>{if(!d||d<=0)return void h("Please enter a valid payment amount");try{let e=await fetch("/return",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({book_id:r.id,member_id:r.member_id,payment:d})}),s=await e.json();console.log("Response data:",s),e.ok?h("Book returned and payment of $".concat(d," processed successfully!")):h("Error: ".concat(s.error||"An error occurred"))}catch(e){h("Failed to process the request")}},g=e=>{s(e),"done"===e&&(r.fee!=r.initial_fee?p():f())};return(0,t.jsxs)(a.Zp,{className:"w-[350px] mx-auto",children:[(0,t.jsxs)(a.aR,{children:[(0,t.jsx)(a.ZB,{children:"Return Book"}),(0,t.jsx)(a.BT,{children:"Return book and make payment"})]}),(0,t.jsxs)(a.Wu,{children:[(0,t.jsx)(a.Zp,{className:"mb-3 mx-auto",children:(0,t.jsxs)(a.Wu,{className:"text-center",children:[(0,t.jsxs)("p",{children:["Book Title: ",null==r?void 0:r.title]}),(0,t.jsx)("br",{}),(0,t.jsxs)("p",{children:["Member name: ",null==r?void 0:r.name]}),(0,t.jsxs)("p",{children:["Fee: ",null==r?void 0:r.fee]})]})}),(0,t.jsxs)("form",{children:[(0,t.jsx)("div",{className:"grid w-full items-center gap-4",children:(0,t.jsx)("div",{className:"flex flex-col space-y-2",children:(0,t.jsx)(o.p,{placeholder:"Enter payment amount",value:d,onChange:e=>i(e.target.value),type:"number",step:"0.1",min:"0"})})}),(0,t.jsx)("p",{className:"text-green-500",children:c})]})]}),(0,t.jsxs)(a.wL,{className:"flex justify-between",children:[(0,t.jsx)(n.$,{variant:"outline",onClick:()=>g("cancel"),children:"Cancel"}),(0,t.jsx)(n.$,{type:"submit",onClick:()=>g("done"),children:"Done"})]})]})}},5623:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},6697:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]])},7340:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},7924:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9249:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(9946).A)("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]])},9357:(e,s,r)=>{Promise.resolve().then(r.bind(r,672))},9946:(e,s,r)=>{"use strict";r.d(s,{A:()=>d});var t=r(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return s.filter((e,s,r)=>!!e&&r.indexOf(e)===s).join(" ")};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,s)=>{let{color:r="currentColor",size:l=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:i="",children:c,iconNode:h,...x}=e;return(0,t.createElement)("svg",{ref:s,...a,width:l,height:l,stroke:r,strokeWidth:d?24*Number(o)/Number(l):o,className:n("lucide",i),...x},[...h.map(e=>{let[s,r]=e;return(0,t.createElement)(s,r)}),...Array.isArray(c)?c:[c]])}),d=(e,s)=>{let r=(0,t.forwardRef)((r,a)=>{let{className:d,...i}=r;return(0,t.createElement)(o,{ref:a,iconNode:s,className:n("lucide-".concat(l(e)),d),...i})});return r.displayName="".concat(e),r}}},e=>{var s=s=>e(e.s=s);e.O(0,[105,932,325,441,684,358],()=>s(9357)),_N_E=e.O()}]);