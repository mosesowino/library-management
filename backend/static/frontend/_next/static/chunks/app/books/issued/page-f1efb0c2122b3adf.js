(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{672:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>C});var r=n(5155),l=n(6874),t=n.n(l),o=n(7340),d=n(4177),i=n(2548),a=n(9249),c=n(381),h=n(2432),x=n(6697),m=n(7924),u=n(5623),j=n(9018),p=n(285),f=n(6695),g=n(4838),b=n(2523),w=n(8382),N=n(5127),k=n(7313),y=n(6102),v=n(3792),T=n(2115),A=n(4746);function C(){let[e,s]=(0,T.useState)([]),[n,l]=(0,T.useState)(!1),[C,D]=(0,T.useState)(null);(0,T.useEffect)(()=>{(async()=>{let e=await fetch("".concat(v.backendUrl,"/issued_books"));if(!e.ok)throw Error("Failed to fetch issued books");let n=await e.json();s(n),console.log("Issued books data:",n)})()},[]);let S=e=>{if("return"===e[0]){let s=new Date().toISOString().split("T")[0],n=new Date(e[5]),r=new Date(s);console.log("Issue Date:",n),console.log("Return Date:",r);let t=Math.max(1,Math.ceil((r-n)/864e5));console.log("Duration:",t);let o=e[4]*t;console.log("Total Fee:",o),D({id:e[1],name:e[2],title:e[3],fee:o,date:e[5],member_id:e[6],initial_fee:e[4]}),console.log("return book"),l(!0)}};return(0,r.jsxs)("div",{className:"flex min-h-screen w-full flex-col bg-slate-800",children:[(0,r.jsxs)("aside",{className:"fixed inset-y-0 left-0 z-10 hidden w-14 flex-col border-r bg-background sm:flex",children:[(0,r.jsxs)("nav",{className:"flex flex-col items-center gap-4 px-2 sm:py-5",children:[(0,r.jsx)(y.TooltipProvider,{children:(0,r.jsxs)(y.Tooltip,{children:[(0,r.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,r.jsxs)(t(),{href:"/",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Dashboard"})]})}),(0,r.jsx)(y.TooltipContent,{side:"right",children:"Dashboard"})]})}),(0,r.jsx)(y.TooltipProvider,{children:(0,r.jsxs)(y.Tooltip,{children:[(0,r.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,r.jsxs)(t(),{href:"#",className:"flex h-9 w-9 items-center justify-center rounded-lg bg-accent text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Issued"})]})}),(0,r.jsx)(y.TooltipContent,{side:"right",children:"Issued"})]})}),(0,r.jsx)(y.TooltipProvider,{children:(0,r.jsxs)(y.Tooltip,{children:[(0,r.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,r.jsxs)(t(),{href:"/books",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,r.jsx)(i.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"books"})]})}),(0,r.jsx)(y.TooltipContent,{side:"right",children:"books"})]})}),(0,r.jsx)(y.TooltipProvider,{children:(0,r.jsxs)(y.Tooltip,{children:[(0,r.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,r.jsxs)(t(),{href:"/members",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,r.jsx)(a.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Members"})]})}),(0,r.jsx)(y.TooltipContent,{side:"right",children:"Members"})]})})]}),(0,r.jsx)("nav",{className:"mt-auto flex flex-col items-center gap-4 px-2 sm:py-5",children:(0,r.jsx)(y.TooltipProvider,{children:(0,r.jsxs)(y.Tooltip,{children:[(0,r.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,r.jsxs)(t(),{href:"#",className:"flex h-9 w-9 items-center justify-center rounded-lg text-muted-foreground transition-colors hover:text-foreground md:h-8 md:w-8",children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Settings"})]})}),(0,r.jsx)(y.TooltipContent,{side:"right",children:"Settings"})]})})})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:gap-4 sm:py-4 sm:pl-14",children:[(0,r.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 items-center gap-4 border-b bg-background px-4 sm:static sm:h-auto sm:border-0 sm:bg-transparent sm:px-6",children:[(0,r.jsxs)(w.Sheet,{children:[(0,r.jsx)(w.SheetTrigger,{asChild:!0,children:(0,r.jsxs)(p.$,{size:"icon",variant:"outline",className:"sm:hidden",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle Menu"})]})}),(0,r.jsx)(w.SheetContent,{side:"left",className:"sm:max-w-xs",children:(0,r.jsxs)("nav",{className:"grid gap-6 text-lg font-medium",children:[(0,r.jsxs)(t(),{href:"/",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),"Dashboard"]}),(0,r.jsxs)(t(),{href:"#",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(d.A,{className:"h-5 w-5"}),"Issued"]}),(0,r.jsxs)(t(),{href:"/books",className:"flex items-center gap-4 px-2.5 text-foreground",children:[(0,r.jsx)(i.A,{className:"h-5 w-5"}),"books"]}),(0,r.jsxs)(t(),{href:"/members",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(a.A,{className:"h-5 w-5"}),"Members"]}),(0,r.jsxs)(t(),{href:"#",className:"flex items-center gap-4 px-2.5 text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Settings"]})]})})]}),(0,r.jsx)(j.Qp,{className:"hidden md:flex",children:(0,r.jsxs)(j.AB,{children:[(0,r.jsx)(j.J5,{children:(0,r.jsx)(j.w1,{asChild:!0,children:(0,r.jsx)(t(),{href:"/",children:"Dashboard"})})}),(0,r.jsx)(j.tH,{}),(0,r.jsx)(j.J5,{children:(0,r.jsx)(j.w1,{asChild:!0,children:(0,r.jsx)(t(),{href:"#",children:"Issued"})})})]})}),(0,r.jsxs)("div",{className:"relative ml-auto flex-1 md:grow-0",children:[(0,r.jsx)(m.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(b.p,{type:"search",placeholder:"Search...",className:"w-full rounded-lg bg-background pl-8 md:w-[200px] lg:w-[336px]"})]}),(0,r.jsxs)(g.DropdownMenu,{children:[(0,r.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsx)(p.$,{variant:"outline",size:"icon",className:"overflow-hidden rounded-full",children:"A"})}),(0,r.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,r.jsx)(g.DropdownMenuLabel,{children:"My Account"}),(0,r.jsx)(g.DropdownMenuSeparator,{}),(0,r.jsx)(g.DropdownMenuItem,{children:"Settings"}),(0,r.jsx)(g.DropdownMenuItem,{children:"Support"}),(0,r.jsx)(g.DropdownMenuSeparator,{}),(0,r.jsx)(g.DropdownMenuItem,{children:"Logout"})]})]})]}),(0,r.jsx)("main",{className:"grid flex-1 items-start gap-4 p-4 sm:px-6 sm:py-0 md:gap-8",children:(0,r.jsxs)(k.Tabs,{defaultValue:"all",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("div",{className:"ml-auto flex items-center gap-2"})}),(0,r.jsx)(k.TabsContent,{value:"all",children:n?(0,r.jsx)(A.default,{onAction:e=>{console.log("Action chosen:",e),"done"===e?(console.log("return book"),setTimeout(()=>l(!1),5e3)):"cancel"===e&&(console.log("cancel return action"),l(!1))},selectedBook:C}):(0,r.jsxs)(f.Zp,{"x-chunk":"dashboard-06-chunk-0",children:[(0,r.jsxs)(f.aR,{children:[(0,r.jsx)(f.ZB,{children:"Issued Books"}),(0,r.jsx)(f.BT,{children:"View and manage returns of issued books."})]}),(0,r.jsx)(f.Wu,{children:(0,r.jsxs)(N.XI,{children:[(0,r.jsx)(N.A0,{children:(0,r.jsxs)(N.Hj,{children:[(0,r.jsx)(N.nd,{children:"Member"}),(0,r.jsx)(N.nd,{children:"Book Title"}),(0,r.jsx)(N.nd,{className:"hidden md:table-cell",children:"Price"}),(0,r.jsx)(N.nd,{className:"hidden md:table-cell",children:"Issue Date"}),(0,r.jsx)(N.nd,{children:(0,r.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,r.jsx)(N.BF,{children:e.map(e=>(0,r.jsxs)(N.Hj,{children:[(0,r.jsxs)(N.nA,{className:"font-medium",children:[e.member_name,(0,r.jsx)("br",{}),(0,r.jsxs)("p",{children:["Id:",e.member_id]})]}),(0,r.jsx)(N.nA,{children:e.book_title}),(0,r.jsx)(N.nA,{className:"hidden md:table-cell",children:e.fee}),(0,r.jsx)(N.nA,{className:"hidden md:table-cell",children:e.issue_date}),(0,r.jsx)(N.nA,{children:(0,r.jsxs)(g.DropdownMenu,{children:[(0,r.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsxs)(p.$,{"aria-haspopup":"true",size:"icon",variant:"ghost",children:[(0,r.jsx)(u.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle menu"})]})}),(0,r.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,r.jsx)(g.DropdownMenuLabel,{children:"Actions"}),(0,r.jsx)(g.DropdownMenuItem,{onClick:()=>S(["return",e.book_id,e.member_name,e.book_title,e.fee,e.issue_date,e.member_id]),children:"Return Book"})]})]})})]},e.book_id))})]})}),(0,r.jsx)(f.wL,{children:(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Showing ",(0,r.jsx)("strong",{children:"1-10"})," of ",(0,r.jsx)("strong",{children:"32"})," ","books"]})})]})})]})})]})]})}},4746:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>a});var r=n(5155),l=n(2115),t=n(285),o=n(6695),d=n(2523),i=n(3792);function a(e){let{onAction:s,selectedBook:n}=e,[a,c]=(0,l.useState)(),[h,x]=(0,l.useState)("");console.log("Selected Book:",n);let[m,u]=(0,l.useState)(!1),[j,p]=(0,l.useState)(!1),f=async()=>{try{let e=await fetch("".concat(i.backendUrl,"/members/debtUpdate/").concat(n.member_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newDebt:n.fee})}),s=await e.json();e.ok?(x(s.message||"Member debt updated successfully!"),g()):x(s.message||"Failed to update member debt.")}catch(e){x("Failed to update member debt.")}},g=async()=>{if(!a||a<=0)return void x("Please enter a valid payment amount");try{let e=await fetch("".concat(i.backendUrl,"/return"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({book_id:n.id,member_id:n.member_id,payment:a})}),s=await e.json();console.log("Response data:",s),e.ok?x("Book returned and payment of $".concat(a," processed successfully!")):x("Error: ".concat(s.error||"An error occurred"))}catch(e){x("Failed to process the request")}},b=e=>{s(e),"done"===e&&(n.fee!=n.initial_fee?f():g())};return(0,r.jsxs)(o.Zp,{className:"w-[350px] mx-auto",children:[(0,r.jsxs)(o.aR,{children:[(0,r.jsx)(o.ZB,{children:"Return Book"}),(0,r.jsx)(o.BT,{children:"Return book and make payment"})]}),(0,r.jsxs)(o.Wu,{children:[(0,r.jsx)(o.Zp,{className:"mb-3 mx-auto",children:(0,r.jsxs)(o.Wu,{className:"text-center",children:[(0,r.jsxs)("p",{children:["Book Title: ",null==n?void 0:n.title]}),(0,r.jsx)("br",{}),(0,r.jsxs)("p",{children:["Member name: ",null==n?void 0:n.name]}),(0,r.jsxs)("p",{children:["Fee: ",null==n?void 0:n.fee]})]})}),(0,r.jsxs)("form",{children:[(0,r.jsx)("div",{className:"grid w-full items-center gap-4",children:(0,r.jsx)("div",{className:"flex flex-col space-y-2",children:(0,r.jsx)(d.p,{placeholder:"Enter payment amount",value:a,onChange:e=>c(e.target.value),type:"number",step:"0.1",min:"0"})})}),(0,r.jsx)("p",{className:"text-green-500",children:h})]})]}),(0,r.jsxs)(o.wL,{className:"flex justify-between",children:[(0,r.jsx)(t.$,{variant:"outline",onClick:()=>b("cancel"),children:"Cancel"}),(0,r.jsx)(t.$,{type:"submit",onClick:()=>b("done"),children:"Done"})]})]})}},5623:(e,s,n)=>{"use strict";n.d(s,{A:()=>r});let r=(0,n(9946).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},9357:(e,s,n)=>{Promise.resolve().then(n.bind(n,672))}},e=>{var s=s=>e(e.s=s);e.O(0,[105,932,464,998,30,441,684,358],()=>s(9357)),_N_E=e.O()}]);