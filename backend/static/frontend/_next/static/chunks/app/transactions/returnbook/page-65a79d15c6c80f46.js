(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48],{4746:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),n=s(2115),r=s(285),l=s(6695),c=s(2523),o=s(3792);function d(e){let{onAction:t,selectedBook:s}=e,[d,i]=(0,n.useState)(),[m,u]=(0,n.useState)("");console.log("Selected Book:",s);let[p,h]=(0,n.useState)(!1),[b,x]=(0,n.useState)(!1),j=async()=>{try{let e=await fetch("".concat(o.backendUrl,"/members/debtUpdate/").concat(s.member_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newDebt:s.fee})}),t=await e.json();e.ok?(u(t.message||"Member debt updated successfully!"),f()):u(t.message||"Failed to update member debt.")}catch(e){u("Failed to update member debt.")}},f=async()=>{if(!d||d<=0)return void u("Please enter a valid payment amount");try{let e=await fetch("".concat(o.backendUrl,"/return"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({book_id:s.id,member_id:s.member_id,payment:d})}),t=await e.json();console.log("Response data:",t),e.ok?u("Book returned and payment of $".concat(d," processed successfully!")):u("Error: ".concat(t.error||"An error occurred"))}catch(e){u("Failed to process the request")}},y=e=>{t(e),"done"===e&&(s.fee!=s.initial_fee?j():f())};return(0,a.jsxs)(l.Zp,{className:"w-[350px] mx-auto",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Return Book"}),(0,a.jsx)(l.BT,{children:"Return book and make payment"})]}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)(l.Zp,{className:"mb-3 mx-auto",children:(0,a.jsxs)(l.Wu,{className:"text-center",children:[(0,a.jsxs)("p",{children:["Book Title: ",null==s?void 0:s.title]}),(0,a.jsx)("br",{}),(0,a.jsxs)("p",{children:["Member name: ",null==s?void 0:s.name]}),(0,a.jsxs)("p",{children:["Fee: ",null==s?void 0:s.fee]})]})}),(0,a.jsxs)("form",{children:[(0,a.jsx)("div",{className:"grid w-full items-center gap-4",children:(0,a.jsx)("div",{className:"flex flex-col space-y-2",children:(0,a.jsx)(c.p,{placeholder:"Enter payment amount",value:d,onChange:e=>i(e.target.value),type:"number",step:"0.1",min:"0"})})}),(0,a.jsx)("p",{className:"text-green-500",children:m})]})]}),(0,a.jsxs)(l.wL,{className:"flex justify-between",children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>y("cancel"),children:"Cancel"}),(0,a.jsx)(r.$,{type:"submit",onClick:()=>y("done"),children:"Done"})]})]})}},6926:(e,t,s)=>{Promise.resolve().then(s.bind(s,4746))}},e=>{var t=t=>e(e.s=t);e.O(0,[105,932,464,998,30,441,684,358],()=>t(6926)),_N_E=e.O()}]);