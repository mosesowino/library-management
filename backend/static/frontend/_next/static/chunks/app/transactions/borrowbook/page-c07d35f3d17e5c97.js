(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[411],{1761:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),l=s(285),r=s(6695),i=s(2523),o=s(3792),n=s(2115),c=s(3464),d=s(9259);function m(){let{memberData:e}=(0,d.U)(),[t,s]=(0,n.useState)([]),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[p,b]=(0,n.useState)([]),f=async()=>{try{let e=await c.A.get("".concat(o.backendUrl,"/books"));e&&e.data&&s(e.data)}catch(e){console.error("Error fetching books:",e)}};(0,n.useEffect)(()=>{f()},[]);let g=t.find(e=>e.author.toLowerCase().includes(m.toLowerCase())||e.title.toLowerCase().includes(m.toLowerCase())),j=null==e?void 0:e.find(e=>String(e.id)===h),v=async e=>{e.preventDefault();try{(await fetch("".concat(o.backendUrl,"/transactions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({book_id:null==g?void 0:g.id,member_id:h})})).ok?(console.log("Transaction successful!"),u(""),x(""),await f()):console.error("Failed to submit transaction")}catch(e){console.error("Error submitting form:",e)}};return(0,a.jsx)("div",{className:"flex min-h-screen w-full flex-col",children:(0,a.jsxs)("main",{className:"flex min-h-[calc(100vh_-_theme(spacing.16))] flex-1 flex-col gap-4 bg-slate-800 p-4 md:gap-8 md:p-10",children:[(0,a.jsx)("div",{className:"mx-auto w-full max-w-6xl",children:(0,a.jsx)("h1",{className:"text-3xl font-semibold",children:"Issue Book"})}),(0,a.jsx)("div",{className:"mx-auto grid w-full max-w-6xl items-start gap-6",children:(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{children:"Member"}),(0,a.jsx)(r.BT,{children:"Enter id of member borrowing book."})]}),(0,a.jsxs)(r.Wu,{children:[(0,a.jsx)("form",{children:(0,a.jsx)(i.p,{type:"text",name:"member_id",placeholder:"Member Id",value:h,onChange:e=>x(e.target.value)})}),j&&(0,a.jsxs)(r.Zp,{className:"py-2 px-4 mt-2",children:[j.name,500>parseInt(j.debt)?(0,a.jsx)("p",{className:"text-green-400",children:"Eligible"}):(0,a.jsx)("p",{className:"text-amber-400",children:"Not Eligible"})]})]})]}),(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{children:[(0,a.jsx)(r.ZB,{children:"Book"}),(0,a.jsx)(r.BT,{children:"Enter book title or author name."})]}),(0,a.jsx)(r.Wu,{children:(0,a.jsxs)("form",{className:"flex flex-col gap-4",onSubmit:v,children:[(0,a.jsx)(i.p,{type:"text",name:"book_id",placeholder:"Title or author",value:m,onChange:e=>{let s=e.target.value;u(s);let a=s.trim().toLowerCase();if(!a)return void b([]);b(t.filter(e=>e.author.toLowerCase().includes(a)||e.title.toLowerCase().includes(a)).slice(0,5))},disabled:!h||j&&parseInt(j.debt)>=500}),(0,a.jsxs)(r.Wu,{children:[p.length>0&&(0,a.jsx)("ul",{className:"absolute bg-white border rounded mt-1 shadow z-10 w-full max-h-60 overflow-y-auto",children:p.map(e=>(0,a.jsxs)("li",{onClick:()=>{u(e.title),b([])},className:"p-2 hover:bg-gray-100 cursor-pointer",children:[e.title," â€” ",e.author,e.total_copies>e.issued_copies?(0,a.jsx)("p",{className:"ml-2 text-green-400",children:"Available"}):(0,a.jsx)("p",{className:"ml-2 text-amber-400",children:"Not Available"})]},e.id))}),(0,a.jsx)(r.wL,{className:"border-t px-6 py-4 mb-0",children:(0,a.jsx)(l.$,{className:"mb-0",type:"submit",disabled:!h||j&&parseInt(j.debt)>500||g&&g.issued_copies>=g.total_copies,children:"Submit"})})]})]})})]})]})})]})})}},8141:(e,t,s)=>{Promise.resolve().then(s.bind(s,1761))},9259:(e,t,s)=>{"use strict";s.d(t,{AppProvider:()=>o,U:()=>n});var a=s(5155),l=s(2115),r=s(3464);let i=(0,l.createContext)(void 0),o=e=>{let{children:t}=e,[s,o]=(0,l.useState)(null);return(0,l.useEffect)(()=>{(async()=>{let e=await r.A.get("http://localhost:5000/members");(null==e?void 0:e.data)&&(localStorage.setItem("members",JSON.stringify(e.data)),o(e.data))})()},[]),(0,a.jsx)(i.Provider,{value:{memberData:s,setMemberData:o},children:t})},n=()=>{let e=(0,l.useContext)(i);if(!e)throw Error("useAppContext must be used within an AppProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[105,932,464,998,30,441,684,358],()=>t(8141)),_N_E=e.O()}]);